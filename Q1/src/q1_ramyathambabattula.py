# -*- coding: utf-8 -*-
"""Q1 RamyaThambabattula.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ULMpSwtyq_4a-44qFfx9618YakuLaJsS
"""

pip install pandas scipy matplotlib

import pandas as pd
from scipy import stats
import matplotlib.pyplot as plt

# Data Acquisition
frailty_data = pd.read_csv("data1.csv")

# Print column to find the exact column names
print(frailty_data.columns)

# Update column names to extra space
hc = 'Height '
wc = 'Weight '
ac = 'Age'

# Data Processing based on Height
cleaned_data_height = frailty_data[frailty_data[hc] > 30].dropna()
cleaned_data_height.to_csv("cleandata1_height.csv", index=False)

# Data Processing based on Age
cleaned_data_age = frailty_data[frailty_data[ac] > 15].dropna()
cleaned_data_age.to_csv("cleandata1_age.csv", index=False)

# Data Analysis with T-test
t_statistic, p_value = stats.ttest_rel(cleaned_data_height[hc], cleaned_data_height[wc])
with open("testingdata1result.txt", "w") as f:
    f.write(f"T-statistic: {t_statistic}\n")
    f.write(f"P-value: {p_value}\n")

# Data Visualization Process
plt.scatter(frailty_data[hc], frailty_data[wc], color='lightgreen')
plt.title("Height Vs Weight")
plt.xlabel("Height")
plt.ylabel("Weight")
plt.show()